package middleware

import (
	"context"
	"fmt"
)

type contextKey struct {
	name string
}

func GetFromContext[V any, I any](i I) (func (context.Context) (*V, error)) {
    typ := fmt.Sprintf("%T", new(V))

    return (func(ctx context.Context) (*V, error) {
        obj := ctx.Value(i)
        if obj == nil {
            return nil, fmt.Errorf("Expected %s", typ)
        }
        req, ok := obj.(*V)
        if !ok {
            return nil, fmt.Errorf("Object stored in request context couldn't convert to %s", typ)
        }
        return req, nil

    })
}
